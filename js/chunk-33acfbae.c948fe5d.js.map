{"version":3,"sources":["webpack:///./src/components/pages/FinalTest.vue?b50d","webpack:///./src/components/pages/FinalTest.vue?a13a","webpack:///src/components/pages/FinalTest.vue","webpack:///./src/components/pages/FinalTest.vue?1895","webpack:///./src/components/pages/FinalTest.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","testItems","length","key","testResult","submitButtonText","isBackplateEnabled","on","onComplete","onTestCompletedChange","isTestCompleted","isModalActive","staticClass","class","isPassed","_v","_s","tableLink","nativeOn","$event","onLookErrors","apply","arguments","_e","staticRenderFns","name","components","AppButton","AppModal","AppTest","AppLoader","computed","$store","getters","attemptsCount","data","homeButtonSize","isLoaderVisible","methods","setModalStatus","dispatch","onMainPage","$router","push","watch","count","until","Date","now","beforeDestroy","onRestart","component"],"mappings":"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","file":"js/chunk-33acfbae.c948fe5d.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FinalTest.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('transition-group',{attrs:{\"appear\":\"\",\"name\":\"fade\"}},[(_vm.testItems && _vm.testItems.length)?_c('app-test',{key:\"app-test\",attrs:{\"testTitle\":\"Финальный тест\",\"testItems\":_vm.testItems,\"testResult\":_vm.testResult,\"submitButtonText\":_vm.submitButtonText,\"isBackplateEnabled\":_vm.isBackplateEnabled,\"testLength\":15},on:{\"on-complete\":_vm.onComplete,\"on-test-completed-change\":_vm.onTestCompletedChange}}):_c('app-loader',{key:\"loader\"}),(_vm.isTestCompleted && _vm.isModalActive)?_c('app-modal',{key:\"modal-window\"},[_c('transition',{attrs:{\"appear\":\"\",\"name\":\"fade\"}},[_c('div',{staticClass:\"modal-content\"},[_c('h3',{class:(\"modal-title\" + (_vm.isPassed ? ' passed' : ' failed'))},[_vm._v(\" \"+_vm._s((\"Тест\" + (_vm.isPassed ? '' : ' не') + \" пройден\"))+\" \")]),_c('div',{staticClass:\"modal-options\"},[(_vm.isPassed)?_c('app-button',{attrs:{\"background\":\"red\",\"width\":300}},[_c('a',{attrs:{\"href\":_vm.tableLink,\"rel\":\"noopener noreferrer\"}},[_vm._v(\"Таблица результатов\")])]):_c('app-button',{attrs:{\"background\":\"red\",\"width\":320},nativeOn:{\"click\":function($event){return _vm.onLookErrors.apply(null, arguments)}}},[_vm._v(\" Посмотреть результат \")])],1)])])],1):_vm._e(),(_vm.isLoaderVisible)?_c('app-loader',{key:\"complete-loader\"}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <transition-group appear name=\"fade\">\r\n    <app-test\r\n      v-if=\"testItems && testItems.length\"\r\n      key=\"app-test\"\r\n      testTitle=\"Финальный тест\"\r\n      :testItems=\"testItems\"\r\n      :testResult=\"testResult\"\r\n      :submitButtonText=\"submitButtonText\"\r\n      :isBackplateEnabled=\"isBackplateEnabled\"\r\n      :testLength=\"15\"\r\n      @on-complete=\"onComplete\"\r\n      @on-test-completed-change=\"onTestCompletedChange\"\r\n    ></app-test>\r\n    <app-loader key=\"loader\" v-else></app-loader>\r\n    <app-modal v-if=\"isTestCompleted && isModalActive\" key=\"modal-window\">\r\n      <transition appear name=\"fade\">\r\n        <div class=\"modal-content\">\r\n          <h3 :class=\"`modal-title${isPassed ? ' passed' : ' failed'}`\">\r\n            {{ `Тест${isPassed ? '' : ' не'} пройден` }}\r\n          </h3>\r\n          <div class=\"modal-options\">\r\n            <app-button v-if=\"isPassed\" background=\"red\" :width=\"300\">\r\n              <a :href=\"tableLink\" rel=\"noopener noreferrer\"\r\n                >Таблица результатов</a\r\n              >\r\n            </app-button>\r\n            <app-button\r\n              v-else\r\n              background=\"red\"\r\n              :width=\"320\"\r\n              @click.native=\"onLookErrors\"\r\n            >\r\n              Посмотреть результат\r\n            </app-button>\r\n          </div>\r\n        </div>\r\n      </transition>\r\n    </app-modal>\r\n    <app-loader key=\"complete-loader\" v-if=\"isLoaderVisible\"></app-loader>\r\n  </transition-group>\r\n</template>\r\n\r\n<script>\r\nimport { ACTIONS, GETTERS, ROUTE_NAMES, url } from '@/constants'\r\n\r\nimport AppButton from '@/components/common/AppButton.vue'\r\nimport AppLoader from '@/components/common/AppLoader.vue'\r\nimport AppModal from '@/components/common/AppModal.vue'\r\nimport AppTest from '@/components/common/AppTest.vue'\r\n\r\nexport default {\r\n  name: 'final-test',\r\n  components: {\r\n    'app-button': AppButton,\r\n    'app-modal': AppModal,\r\n    'app-test': AppTest,\r\n    'app-loader': AppLoader\r\n  },\r\n  computed: {\r\n    testItems() {\r\n      return this.$store.getters[GETTERS.GET_FINAL_TEST]\r\n    },\r\n    isModalActive() {\r\n      return this.$store.getters[GETTERS.GET_IS_MODAL_ACTIVE]\r\n    },\r\n    testResult() {\r\n      return this.$store.getters[GETTERS.GET_FINAL_TEST_RESULT]\r\n    },\r\n    isPassed() {\r\n      return this.$store.getters[GETTERS.GET_FINAL_TEST_PASSED_STATUS]\r\n    },\r\n    attemptsCount() {\r\n      return this.$store.getters[GETTERS.GET_FINAL_TEST_ATTEMPTS_COUNTER]\r\n    },\r\n    submitButtonText() {\r\n      return this.attemptsCount === 0\r\n        ? 'На главную'\r\n        : Object.keys(this.testResult).length && !this.isPassed\r\n        ? 'Повторить'\r\n        : undefined\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      isTestCompleted: false,\r\n      homeButtonSize: 150,\r\n      isBackplateEnabled: false,\r\n      isLoaderVisible: false,\r\n      tableLink: url.sheet\r\n    }\r\n  },\r\n  methods: {\r\n    async onComplete(payload) {\r\n      this.isLoaderVisible = true\r\n      if (!this.submitButtonText) {\r\n        await this.$store.dispatch(ACTIONS.SEND_FINAL_TEST_RESULT, {\r\n          answers: payload.answers\r\n        })\r\n        this.isLoaderVisible = false\r\n        this.setModalStatus(true)\r\n      } else {\r\n        if (this.attemptsCount) {\r\n          await this.onRestart()\r\n        } else {\r\n          this.$router.push({ name: ROUTE_NAMES.HOME })\r\n        }\r\n      }\r\n    },\r\n    async fetchTest() {\r\n      if (this.isPassed) return console.log('Final test already passed')\r\n      await this.$store.dispatch(ACTIONS.FETCH_FINAL_TEST)\r\n    },\r\n    async onRestart() {\r\n      await this.fetchTest()\r\n      this.$root.$emit('on-test-restart')\r\n      this.setModalStatus(false)\r\n      this.isBackplateEnabled = false\r\n      this.isLoaderVisible = false\r\n    },\r\n    onLookErrors() {\r\n      this.isBackplateEnabled = true\r\n      this.setModalStatus(false)\r\n    },\r\n    onTestCompletedChange(isTestCompleted) {\r\n      this.isTestCompleted = isTestCompleted\r\n    },\r\n    setModalStatus(status) {\r\n      this.$store.dispatch(ACTIONS.SET_MODAL_STATUS, { status })\r\n    },\r\n    onMainPage() {\r\n      this.$router.push({ name: ROUTE_NAMES.HOME })\r\n    }\r\n  },\r\n  watch: {\r\n    attemptsCount: function(count) {\r\n      if (!count && !this.isPassed) {\r\n        this.$store.dispatch(ACTIONS.SET_FINAL_TEST_DISABLED_UNTIL, {\r\n          until: Date.now() + 1000 * 60 * 5\r\n        })\r\n      }\r\n    }\r\n  },\r\n  async created() {\r\n    if (!this.testItems?.length && !this.isPassed) {\r\n      try {\r\n        await this.fetchTest()\r\n      } catch (e) {\r\n        console.error(e)\r\n      }\r\n    }\r\n  },\r\n  beforeDestroy() {\r\n    this.setModalStatus(false)\r\n    this.onRestart()\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n@import '@/assets/transition.scss';\r\n\r\nbody {\r\n  overflow-y: hidden;\r\n}\r\n\r\n.modal {\r\n  &-title {\r\n    font-size: 1.8rem;\r\n    text-align: center;\r\n    padding-bottom: 3rem;\r\n    &.passed {\r\n      color: rgb(50, 150, 50);\r\n    }\r\n    &.failed {\r\n      color: rgb(200, 50, 50);\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FinalTest.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FinalTest.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./FinalTest.vue?vue&type=template&id=499e791e&\"\nimport script from \"./FinalTest.vue?vue&type=script&lang=js&\"\nexport * from \"./FinalTest.vue?vue&type=script&lang=js&\"\nimport style0 from \"./FinalTest.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}